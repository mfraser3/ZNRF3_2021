## FRASER ET AL - FIGURE 4

## LOAD LIBRARIES ####
library(tidyverse)
library(readxl)
library(cowplot)
library(patchwork)

#
#### LOAD BINARY FEATURES ####
saveRDS(ZNRF3_BINARY_FEATURES, "/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_BINARY_FEATURES.rds")
ZNRF3_BINARY_FEATURES <- readRDS("/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_BINARY_FEATURES.rds")

### TIDY DATA ####
ZNRF3.BINARY.TIDY <- ZNRF3_BINARY_FEATURES %>% tidyr::gather(sample,mutated, 2:366)
ZNRF3.BINARY.TIDY$mutated <- factor(ZNRF3.BINARY.TIDY$mutated)
ZNRF3.BINARY.TIDY$sample <- factor(ZNRF3.BINARY.TIDY$sample, levels = c('CPCG0187',
                                                                        'CPCG0126',
                                                                        'CPCG0454',
                                                                        'CPCG0184',
                                                                        'CPCG0320',
                                                                        'CPCG0288',
                                                                        'CPCG0382',
                                                                        'CPCG0298',
                                                                        'CPCG0316',
                                                                        'CPCG0582',
                                                                        'CPCG0545',
                                                                        'CPCG0068',
                                                                        'CPCG0379',
                                                                        'CPCG0448',
                                                                        'CPCG0201',
                                                                        'CPCG0579',
                                                                        'CPCG0345',
                                                                        'CPCG0314',
                                                                        'CPCG0003',
                                                                        'CPCG0453',
                                                                        'CPCG0323',
                                                                        'CPCG0322',
                                                                        'CPCG0132',
                                                                        'CPCG0299',
                                                                        'CPCG0099',
                                                                        'CPCG0158',
                                                                        'CPCG0240',
                                                                        'CPCG0307',
                                                                        'CPCG0069',
                                                                        'CPCG0457',
                                                                        'CPCG0073',
                                                                        'CPCG0292',
                                                                        'CPCG0006',
                                                                        'CPCG0321',
                                                                        'CPCG0094',
                                                                        'CPCG0063',
                                                                        'CPCG0297',
                                                                        'CPCG0002',
                                                                        'CPCG0100',
                                                                        'CPCG0196',
                                                                        'CPCG0333',
                                                                        'CPCG0306',
                                                                        'CPCG0455',
                                                                        'CPCG0078',
                                                                        'CPCG0119',
                                                                        'CPCG0009',
                                                                        'CPCG0233',
                                                                        'CPCG0183',
                                                                        'CPCG0235',
                                                                        'CPCG0294',
                                                                        'CPCG0083',
                                                                        'CPCG0412',
                                                                        'CPCG0540',
                                                                        'CPCG0302',
                                                                        'CPCG0315',
                                                                        'CPCG0274',
                                                                        'CPCG0289',
                                                                        'CPCG0263',
                                                                        'CPCG0398',
                                                                        'CPCG0404',
                                                                        'CPCG0076',
                                                                        'CPCG0589',
                                                                        'CPCG0598',
                                                                        'CPCG0236',
                                                                        'CPCG0043',
                                                                        'CPCG0547',
                                                                        'CPCG0130',
                                                                        'CPCG0266',
                                                                        'CPCG0397',
                                                                        'CPCG0192',
                                                                        'CPCG0007',
                                                                        'CPCG0311',
                                                                        'CPCG0232',
                                                                        'CPCG0581',
                                                                        'CPCG0282',
                                                                        'CPCG0008',
                                                                        'CPCG0004',
                                                                        'CPCG0394',
                                                                        'CPCG0098',
                                                                        'CPCG0036',
                                                                        'CPCG0433',
                                                                        'CPCG0606',
                                                                        'CPCG0204',
                                                                        'CPCG0295',
                                                                        'CPCG0592',
                                                                        'CPCG0468',
                                                                        'CPCG0310',
                                                                        'CPCG0588',
                                                                        'CPCG0117',
                                                                        'CPCG0437',
                                                                        'CPCG0462',
                                                                        'CPCG0082',
                                                                        'CPCG0081',
                                                                        'CPCG0374',
                                                                        'CPCG0369',
                                                                        'CPCG0040',
                                                                        'CPCG0388',
                                                                        'CPCG0347',
                                                                        'CPCG0191',
                                                                        'CPCG0503',
                                                                        'CPCG0057',
                                                                        'CPCG0301',
                                                                        'CPCG0281',
                                                                        'CPCG0271',
                                                                        'CPCG0249',
                                                                        'CPCG0095',
                                                                        'CPCG0597',
                                                                        'CPCG0093',
                                                                        'CPCG0392',
                                                                        'CPCG0330',
                                                                        'CPCG0358',
                                                                        'CPCG0498',
                                                                        'CPCG0357',
                                                                        'CPCG0569',
                                                                        'CPCG0318',
                                                                        'CPCG0248',
                                                                        'CPCG0296',
                                                                        'CPCG0335',
                                                                        'CPCG0328',
                                                                        'CPCG0487',
                                                                        'CPCG0001',
                                                                        'CPCG0590',
                                                                        'CPCG0260',
                                                                        'CPCG0550',
                                                                        'CPCG0432',
                                                                        'CPCG0206',
                                                                        'CPCG0514',
                                                                        'CPCG0396',
                                                                        'CPCG0573',
                                                                        'CPCG0410',
                                                                        'CPCG0334',
                                                                        'CPCG0304',
                                                                        'CPCG0340',
                                                                        'CPCG0349',
                                                                        'CPCG0042',
                                                                        'CPCG0551',
                                                                        'CPCG0087',
                                                                        'CPCG0242',
                                                                        'CPCG0189',
                                                                        'CPCG0346',
                                                                        'CPCG0222',
                                                                        'CPCG0416',
                                                                        'CPCG0471',
                                                                        'CPCG0360',
                                                                        'CPCG0212',
                                                                        'CPCG0262',
                                                                        'CPCG0227',
                                                                        'CPCG0129',
                                                                        'CPCG0091',
                                                                        'CPCG0500',
                                                                        'CPCG0211',
                                                                        'CPCG0107',
                                                                        'CPCG0439',
                                                                        'CPCG0375',
                                                                        'CPCG0350',
                                                                        'CPCG0499',
                                                                        'CPCG0190',
                                                                        'CPCG0464',
                                                                        'CPCG0519',
                                                                        'CPCG0121',
                                                                        'CPCG0378',
                                                                        'CPCG0565',
                                                                        'CPCG0574',
                                                                        'CPCG0188',
                                                                        'CPCG0203',
                                                                        'CPCG0241',
                                                                        'CPCG0601',
                                                                        'CPCG0371',
                                                                        'CPCG0459',
                                                                        'CPCG0324',
                                                                        'CPCG0490',
                                                                        'CPCG0523',
                                                                        'CPCG0185',
                                                                        'CPCG0213',
                                                                        'CPCG0467',
                                                                        'CPCG0560',
                                                                        'CPCG0072',
                                                                        'CPCG0331',
                                                                        'CPCG0489',
                                                                        'CPCG0407',
                                                                        'CPCG0572',
                                                                        'CPCG0380',
                                                                        'CPCG0308',
                                                                        'CPCG0194',
                                                                        'CPCG0577',
                                                                        'CPCG0221',
                                                                        'CPCG0395',
                                                                        'CPCG0434',
                                                                        'CPCG0406',
                                                                        'CPCG0303',
                                                                        'CPCG0426',
                                                                        'CPCG0472',
                                                                        'CPCG0131',
                                                                        'CPCG0607',
                                                                        'CPCG0210',
                                                                        'CPCG0228',
                                                                        'CPCG0502',
                                                                        'CPCG0291',
                                                                        'CPCG0341',
                                                                        'CPCG0255',
                                                                        'CPCG0352',
                                                                        'CPCG0372',
                                                                        'CPCG0356',
                                                                        'CPCG0238',
                                                                        'CPCG0268',
                                                                        'CPCG0125',
                                                                        'CPCG0344',
                                                                        'CPCG0059',
                                                                        'CPCG0265',
                                                                        'CPCG0128',
                                                                        'CPCG0353',
                                                                        'CPCG0019',
                                                                        'CPCG0319',
                                                                        'CPCG0413',
                                                                        'CPCG0048',
                                                                        'CPCG0605',
                                                                        'CPCG0283',
                                                                        'CPCG0313',
                                                                        'CPCG0015',
                                                                        'CPCG0561',
                                                                        'CPCG0096',
                                                                        'CPCG0280',
                                                                        'CPCG0578',
                                                                        'CPCG0182',
                                                                        'CPCG0305',
                                                                        'CPCG0339',
                                                                        'CPCG0208',
                                                                        'CPCG0445',
                                                                        'CPCG0534',
                                                                        'CPCG0600',
                                                                        'CPCG0496',
                                                                        'CPCG0124',
                                                                        'CPCG0220',
                                                                        'CPCG0075',
                                                                        'CPCG0354',
                                                                        'CPCG0452',
                                                                        'CPCG0418',
                                                                        'CPCG0409',
                                                                        'CPCG0364',
                                                                        'CPCG0387',
                                                                        'CPCG0199',
                                                                        'CPCG0278',
                                                                        'CPCG0285',
                                                                        'CPCG0465',
                                                                        'CPCG0348',
                                                                        'CPCG0522',
                                                                        'CPCG0046',
                                                                        'CPCG0408',
                                                                        'CPCG0529',
                                                                        'CPCG0123',
                                                                        'CPCG0114',
                                                                        'CPCG0563',
                                                                        'CPCG0423',
                                                                        'CPCG0596',
                                                                        'CPCG0229',
                                                                        'CPCG0200',
                                                                        'CPCG0484',
                                                                        'CPCG0258',
                                                                        'CPCG0533',
                                                                        'CPCG0377',
                                                                        'CPCG0571',
                                                                        'CPCG0342',
                                                                        'CPCG0269',
                                                                        'CPCG0482',
                                                                        'CPCG0458',
                                                                        'CPCG0532',
                                                                        'CPCG0401',
                                                                        'CPCG0463',
                                                                        'CPCG0604',
                                                                        'CPCG0225',
                                                                        'CPCG0531',
                                                                        'CPCG0066',
                                                                        'CPCG0576',
                                                                        'CPCG0089',
                                                                        'CPCG0205',
                                                                        'CPCG0097',
                                                                        'CPCG0090',
                                                                        'CPCG0362',
                                                                        'CPCG0267',
                                                                        'CPCG0030',
                                                                        'CPCG0074',
                                                                        'CPCG0456',
                                                                        'CPCG0246',
                                                                        'CPCG0568',
                                                                        'CPCG0336',
                                                                        'CPCG0286',
                                                                        'CPCG0570',
                                                                        'CPCG0256',
                                                                        'CPCG0361',
                                                                        'CPCG0326',
                                                                        'CPCG0329',
                                                                        'CPCG0428',
                                                                        'CPCG0005',
                                                                        'CPCG0435',
                                                                        'CPCG0300',
                                                                        'CPCG0257',
                                                                        'CPCG0355',
                                                                        'CPCG0504',
                                                                        'CPCG0593',
                                                                        'CPCG0470',
                                                                        'CPCG0492',
                                                                        'CPCG0599',
                                                                        'CPCG0365',
                                                                        'CPCG0259',
                                                                        'CPCG0414',
                                                                        'CPCG0559',
                                                                        'CPCG0217',
                                                                        'CPCG0521',
                                                                        'CPCG0451',
                                                                        'CPCG0027',
                                                                        'CPCG0084',
                                                                        'CPCG0219',
                                                                        'CPCG0602',
                                                                        'CPCG0070',
                                                                        'CPCG0566',
                                                                        'CPCG0524',
                                                                        'CPCG0411',
                                                                        'CPCG0528',
                                                                        'CPCG0309',
                                                                        'CPCG0520',
                                                                        'CPCG0567',
                                                                        'CPCG0251',
                                                                        'CPCG0508',
                                                                        'CPCG0466',
                                                                        'CPCG0312',
                                                                        'CPCG0234',
                                                                        'CPCG0166',
                                                                        'CPCG0474',
                                                                        'CPCG0594',
                                                                        'CPCG0103',
                                                                        'CPCG0391',
                                                                        'CPCG0373',
                                                                        'CPCG0363',
                                                                        'CPCG0415',
                                                                        'CPCG0562',
                                                                        'CPCG0575',
                                                                        'CPCG0127',
                                                                        'CPCG0486',
                                                                        'CPCG0020',
                                                                        'CPCG0483',
                                                                        'CPCG0424',
                                                                        'CPCG0226',
                                                                        'CPCG0327',
                                                                        'CPCG0381',
                                                                        'CPCG0595',
                                                                        'CPCG0526',
                                                                        'CPCG0587',
                                                                        'CPCG0154',
                                                                        'CPCG0067',
                                                                        'CPCG0580',
                                                                        'CPCG0368',
                                                                        'CPCG0603',
                                                                        'CPCG0050',
                                                                        'CPCG0250',
                                                                        'CPCG0525',
                                                                        'CPCG0527',
                                                                        'CPCG0022',
                                                                        'CPCG0539',
                                                                        'CPCG0277',
                                                                        'CPCG0102',
                                                                        'CPCG0122',
                                                                        'CPCG0198',
                                                                        'CPCG0237',
                                                                        'CPCG0243',
                                                                        'CPCG0287'
))
ZNRF3.BINARY.TIDY$feature <- factor(ZNRF3.BINARY.TIDY$feature, levels = c('IDCP','ETS', 'METASTASIS', 'BCR30', 'BCR', 'ZNRF3'))

mylabels <- list("IDC-P/CA", "ETS Fusion Status", "Metastasis", "Early BCR", "BCR", expression(paste(italic("ZNRF3"), " Loss")))

## DRAW LEGEND HEATMAP ####
ZNRF3.BINARY.HEATMAP <- ggplot(ZNRF3.BINARY.TIDY, aes(x = sample, y = feature, fill = mutated)) + 
  geom_tile(color = "black", size = 0.1) + coord_equal(ratio = 5) +
  scale_fill_manual(name = "",
                    labels = c("Present", "Absent", "Missing"), values = c("white", "dodgerblue2"), na.value = "grey30") +
  scale_y_discrete(labels = c(expression(paste(bold("IDC-P/CA"))),
                              expression(paste(bold("ETS Fusion Status"))),
                              expression(paste(bold("Metastasis"))),
                              expression(paste(bold("Early BCR"))),
                              expression(paste(bold("BCR"))),
                              expression(paste(bolditalic("ZNRF3"), bold(" Loss"))))) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    axis.text.y = element_text(face = "bold",
                               size = 18,
                               color = "black"),
    legend.title = element_blank(),
    legend.text = element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    plot.margin = unit(c(0, 0, 0, 0), "cm")
  )
ZNRF3.BINARY.HEATMAP

#
#### GLEASON HEATMAP ####
saveRDS(ZNRF3_GLEASON, "/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_GLEASON.rds")
ZNRF3_GLEASON <- readRDS("/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_GLEASON.rds")

### TIDY DATA ####
ZNRF3.GLEASON.TIDY <- ZNRF3_GLEASON %>% tidyr::gather(sample,mutated, 2:366)

ZNRF3.GLEASON.TIDY$mutated <- factor(ZNRF3.GLEASON.TIDY$mutated)
ZNRF3.GLEASON.TIDY$sample <- factor(ZNRF3.GLEASON.TIDY$sample, levels = c('CPCG0187',
                                                                          'CPCG0126',
                                                                          'CPCG0454',
                                                                          'CPCG0184',
                                                                          'CPCG0320',
                                                                          'CPCG0288',
                                                                          'CPCG0382',
                                                                          'CPCG0298',
                                                                          'CPCG0316',
                                                                          'CPCG0582',
                                                                          'CPCG0545',
                                                                          'CPCG0068',
                                                                          'CPCG0379',
                                                                          'CPCG0448',
                                                                          'CPCG0201',
                                                                          'CPCG0579',
                                                                          'CPCG0345',
                                                                          'CPCG0314',
                                                                          'CPCG0003',
                                                                          'CPCG0453',
                                                                          'CPCG0323',
                                                                          'CPCG0322',
                                                                          'CPCG0132',
                                                                          'CPCG0299',
                                                                          'CPCG0099',
                                                                          'CPCG0158',
                                                                          'CPCG0240',
                                                                          'CPCG0307',
                                                                          'CPCG0069',
                                                                          'CPCG0457',
                                                                          'CPCG0073',
                                                                          'CPCG0292',
                                                                          'CPCG0006',
                                                                          'CPCG0321',
                                                                          'CPCG0094',
                                                                          'CPCG0063',
                                                                          'CPCG0297',
                                                                          'CPCG0002',
                                                                          'CPCG0100',
                                                                          'CPCG0196',
                                                                          'CPCG0333',
                                                                          'CPCG0306',
                                                                          'CPCG0455',
                                                                          'CPCG0078',
                                                                          'CPCG0119',
                                                                          'CPCG0009',
                                                                          'CPCG0233',
                                                                          'CPCG0183',
                                                                          'CPCG0235',
                                                                          'CPCG0294',
                                                                          'CPCG0083',
                                                                          'CPCG0412',
                                                                          'CPCG0540',
                                                                          'CPCG0302',
                                                                          'CPCG0315',
                                                                          'CPCG0274',
                                                                          'CPCG0289',
                                                                          'CPCG0263',
                                                                          'CPCG0398',
                                                                          'CPCG0404',
                                                                          'CPCG0076',
                                                                          'CPCG0589',
                                                                          'CPCG0598',
                                                                          'CPCG0236',
                                                                          'CPCG0043',
                                                                          'CPCG0547',
                                                                          'CPCG0130',
                                                                          'CPCG0266',
                                                                          'CPCG0397',
                                                                          'CPCG0192',
                                                                          'CPCG0007',
                                                                          'CPCG0311',
                                                                          'CPCG0232',
                                                                          'CPCG0581',
                                                                          'CPCG0282',
                                                                          'CPCG0008',
                                                                          'CPCG0004',
                                                                          'CPCG0394',
                                                                          'CPCG0098',
                                                                          'CPCG0036',
                                                                          'CPCG0433',
                                                                          'CPCG0606',
                                                                          'CPCG0204',
                                                                          'CPCG0295',
                                                                          'CPCG0592',
                                                                          'CPCG0468',
                                                                          'CPCG0310',
                                                                          'CPCG0588',
                                                                          'CPCG0117',
                                                                          'CPCG0437',
                                                                          'CPCG0462',
                                                                          'CPCG0082',
                                                                          'CPCG0081',
                                                                          'CPCG0374',
                                                                          'CPCG0369',
                                                                          'CPCG0040',
                                                                          'CPCG0388',
                                                                          'CPCG0347',
                                                                          'CPCG0191',
                                                                          'CPCG0503',
                                                                          'CPCG0057',
                                                                          'CPCG0301',
                                                                          'CPCG0281',
                                                                          'CPCG0271',
                                                                          'CPCG0249',
                                                                          'CPCG0095',
                                                                          'CPCG0597',
                                                                          'CPCG0093',
                                                                          'CPCG0392',
                                                                          'CPCG0330',
                                                                          'CPCG0358',
                                                                          'CPCG0498',
                                                                          'CPCG0357',
                                                                          'CPCG0569',
                                                                          'CPCG0318',
                                                                          'CPCG0248',
                                                                          'CPCG0296',
                                                                          'CPCG0335',
                                                                          'CPCG0328',
                                                                          'CPCG0487',
                                                                          'CPCG0001',
                                                                          'CPCG0590',
                                                                          'CPCG0260',
                                                                          'CPCG0550',
                                                                          'CPCG0432',
                                                                          'CPCG0206',
                                                                          'CPCG0514',
                                                                          'CPCG0396',
                                                                          'CPCG0573',
                                                                          'CPCG0410',
                                                                          'CPCG0334',
                                                                          'CPCG0304',
                                                                          'CPCG0340',
                                                                          'CPCG0349',
                                                                          'CPCG0042',
                                                                          'CPCG0551',
                                                                          'CPCG0087',
                                                                          'CPCG0242',
                                                                          'CPCG0189',
                                                                          'CPCG0346',
                                                                          'CPCG0222',
                                                                          'CPCG0416',
                                                                          'CPCG0471',
                                                                          'CPCG0360',
                                                                          'CPCG0212',
                                                                          'CPCG0262',
                                                                          'CPCG0227',
                                                                          'CPCG0129',
                                                                          'CPCG0091',
                                                                          'CPCG0500',
                                                                          'CPCG0211',
                                                                          'CPCG0107',
                                                                          'CPCG0439',
                                                                          'CPCG0375',
                                                                          'CPCG0350',
                                                                          'CPCG0499',
                                                                          'CPCG0190',
                                                                          'CPCG0464',
                                                                          'CPCG0519',
                                                                          'CPCG0121',
                                                                          'CPCG0378',
                                                                          'CPCG0565',
                                                                          'CPCG0574',
                                                                          'CPCG0188',
                                                                          'CPCG0203',
                                                                          'CPCG0241',
                                                                          'CPCG0601',
                                                                          'CPCG0371',
                                                                          'CPCG0459',
                                                                          'CPCG0324',
                                                                          'CPCG0490',
                                                                          'CPCG0523',
                                                                          'CPCG0185',
                                                                          'CPCG0213',
                                                                          'CPCG0467',
                                                                          'CPCG0560',
                                                                          'CPCG0072',
                                                                          'CPCG0331',
                                                                          'CPCG0489',
                                                                          'CPCG0407',
                                                                          'CPCG0572',
                                                                          'CPCG0380',
                                                                          'CPCG0308',
                                                                          'CPCG0194',
                                                                          'CPCG0577',
                                                                          'CPCG0221',
                                                                          'CPCG0395',
                                                                          'CPCG0434',
                                                                          'CPCG0406',
                                                                          'CPCG0303',
                                                                          'CPCG0426',
                                                                          'CPCG0472',
                                                                          'CPCG0131',
                                                                          'CPCG0607',
                                                                          'CPCG0210',
                                                                          'CPCG0228',
                                                                          'CPCG0502',
                                                                          'CPCG0291',
                                                                          'CPCG0341',
                                                                          'CPCG0255',
                                                                          'CPCG0352',
                                                                          'CPCG0372',
                                                                          'CPCG0356',
                                                                          'CPCG0238',
                                                                          'CPCG0268',
                                                                          'CPCG0125',
                                                                          'CPCG0344',
                                                                          'CPCG0059',
                                                                          'CPCG0265',
                                                                          'CPCG0128',
                                                                          'CPCG0353',
                                                                          'CPCG0019',
                                                                          'CPCG0319',
                                                                          'CPCG0413',
                                                                          'CPCG0048',
                                                                          'CPCG0605',
                                                                          'CPCG0283',
                                                                          'CPCG0313',
                                                                          'CPCG0015',
                                                                          'CPCG0561',
                                                                          'CPCG0096',
                                                                          'CPCG0280',
                                                                          'CPCG0578',
                                                                          'CPCG0182',
                                                                          'CPCG0305',
                                                                          'CPCG0339',
                                                                          'CPCG0208',
                                                                          'CPCG0445',
                                                                          'CPCG0534',
                                                                          'CPCG0600',
                                                                          'CPCG0496',
                                                                          'CPCG0124',
                                                                          'CPCG0220',
                                                                          'CPCG0075',
                                                                          'CPCG0354',
                                                                          'CPCG0452',
                                                                          'CPCG0418',
                                                                          'CPCG0409',
                                                                          'CPCG0364',
                                                                          'CPCG0387',
                                                                          'CPCG0199',
                                                                          'CPCG0278',
                                                                          'CPCG0285',
                                                                          'CPCG0465',
                                                                          'CPCG0348',
                                                                          'CPCG0522',
                                                                          'CPCG0046',
                                                                          'CPCG0408',
                                                                          'CPCG0529',
                                                                          'CPCG0123',
                                                                          'CPCG0114',
                                                                          'CPCG0563',
                                                                          'CPCG0423',
                                                                          'CPCG0596',
                                                                          'CPCG0229',
                                                                          'CPCG0200',
                                                                          'CPCG0484',
                                                                          'CPCG0258',
                                                                          'CPCG0533',
                                                                          'CPCG0377',
                                                                          'CPCG0571',
                                                                          'CPCG0342',
                                                                          'CPCG0269',
                                                                          'CPCG0482',
                                                                          'CPCG0458',
                                                                          'CPCG0532',
                                                                          'CPCG0401',
                                                                          'CPCG0463',
                                                                          'CPCG0604',
                                                                          'CPCG0225',
                                                                          'CPCG0531',
                                                                          'CPCG0066',
                                                                          'CPCG0576',
                                                                          'CPCG0089',
                                                                          'CPCG0205',
                                                                          'CPCG0097',
                                                                          'CPCG0090',
                                                                          'CPCG0362',
                                                                          'CPCG0267',
                                                                          'CPCG0030',
                                                                          'CPCG0074',
                                                                          'CPCG0456',
                                                                          'CPCG0246',
                                                                          'CPCG0568',
                                                                          'CPCG0336',
                                                                          'CPCG0286',
                                                                          'CPCG0570',
                                                                          'CPCG0256',
                                                                          'CPCG0361',
                                                                          'CPCG0326',
                                                                          'CPCG0329',
                                                                          'CPCG0428',
                                                                          'CPCG0005',
                                                                          'CPCG0435',
                                                                          'CPCG0300',
                                                                          'CPCG0257',
                                                                          'CPCG0355',
                                                                          'CPCG0504',
                                                                          'CPCG0593',
                                                                          'CPCG0470',
                                                                          'CPCG0492',
                                                                          'CPCG0599',
                                                                          'CPCG0365',
                                                                          'CPCG0259',
                                                                          'CPCG0414',
                                                                          'CPCG0559',
                                                                          'CPCG0217',
                                                                          'CPCG0521',
                                                                          'CPCG0451',
                                                                          'CPCG0027',
                                                                          'CPCG0084',
                                                                          'CPCG0219',
                                                                          'CPCG0602',
                                                                          'CPCG0070',
                                                                          'CPCG0566',
                                                                          'CPCG0524',
                                                                          'CPCG0411',
                                                                          'CPCG0528',
                                                                          'CPCG0309',
                                                                          'CPCG0520',
                                                                          'CPCG0567',
                                                                          'CPCG0251',
                                                                          'CPCG0508',
                                                                          'CPCG0466',
                                                                          'CPCG0312',
                                                                          'CPCG0234',
                                                                          'CPCG0166',
                                                                          'CPCG0474',
                                                                          'CPCG0594',
                                                                          'CPCG0103',
                                                                          'CPCG0391',
                                                                          'CPCG0373',
                                                                          'CPCG0363',
                                                                          'CPCG0415',
                                                                          'CPCG0562',
                                                                          'CPCG0575',
                                                                          'CPCG0127',
                                                                          'CPCG0486',
                                                                          'CPCG0020',
                                                                          'CPCG0483',
                                                                          'CPCG0424',
                                                                          'CPCG0226',
                                                                          'CPCG0327',
                                                                          'CPCG0381',
                                                                          'CPCG0595',
                                                                          'CPCG0526',
                                                                          'CPCG0587',
                                                                          'CPCG0154',
                                                                          'CPCG0067',
                                                                          'CPCG0580',
                                                                          'CPCG0368',
                                                                          'CPCG0603',
                                                                          'CPCG0050',
                                                                          'CPCG0250',
                                                                          'CPCG0525',
                                                                          'CPCG0527',
                                                                          'CPCG0022',
                                                                          'CPCG0539',
                                                                          'CPCG0277',
                                                                          'CPCG0102',
                                                                          'CPCG0122',
                                                                          'CPCG0198',
                                                                          'CPCG0237',
                                                                          'CPCG0243',
                                                                          'CPCG0287'
))
ZNRF3.GLEASON.TIDY$feature <- factor(ZNRF3.GLEASON.TIDY$feature, levels = c('CLINICAL.T.CAT', 'PSA', 'GLEASON'))
View(ZNRF3.GLEASON.TIDY)

### DRAW GLEASON LEGEND HEATMAP ####
ZNRF3.GLEASON.HEATMAP <- ggplot(ZNRF3.GLEASON.TIDY, aes(x = sample, y = feature, fill = mutated)) + 
  geom_tile(color = "black", size = 0.1) + coord_equal(ratio = 5) +
  scale_fill_manual(name = "",
                    labels = c("Present", "Absent", "Missing"), values = c("white", "yellow", "orange", "red"), na.value = "grey30") +
  scale_y_discrete(labels = c("Gleason Score")) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    axis.text.y = element_text(face = "bold",
                               size = 18,
                               color = "black"),
    legend.title = element_blank(),
    legend.text = element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    plot.margin = unit(c(0, 0, 0, 0), "cm")
  )
ZNRF3.GLEASON.HEATMAP




#
#### PSA HEATMAP ####

saveRDS(ZNRF3_PSA, "/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_PSA.rds")
ZNRF3_PSA <- readRDS("/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_PSA.rds")

### TIDY DATA ####
ZNRF3.PSA.TIDY <- ZNRF3_PSA %>% tidyr::gather(sample,mutated, 2:366)
ZNRF3.PSA.TIDY$mutated <- factor(ZNRF3.PSA.TIDY$mutated)
ZNRF3.PSA.TIDY$sample <- factor(ZNRF3.PSA.TIDY$sample, levels = c('CPCG0187',
                                                                  'CPCG0126',
                                                                  'CPCG0454',
                                                                  'CPCG0184',
                                                                  'CPCG0320',
                                                                  'CPCG0288',
                                                                  'CPCG0382',
                                                                  'CPCG0298',
                                                                  'CPCG0316',
                                                                  'CPCG0582',
                                                                  'CPCG0545',
                                                                  'CPCG0068',
                                                                  'CPCG0379',
                                                                  'CPCG0448',
                                                                  'CPCG0201',
                                                                  'CPCG0579',
                                                                  'CPCG0345',
                                                                  'CPCG0314',
                                                                  'CPCG0003',
                                                                  'CPCG0453',
                                                                  'CPCG0323',
                                                                  'CPCG0322',
                                                                  'CPCG0132',
                                                                  'CPCG0299',
                                                                  'CPCG0099',
                                                                  'CPCG0158',
                                                                  'CPCG0240',
                                                                  'CPCG0307',
                                                                  'CPCG0069',
                                                                  'CPCG0457',
                                                                  'CPCG0073',
                                                                  'CPCG0292',
                                                                  'CPCG0006',
                                                                  'CPCG0321',
                                                                  'CPCG0094',
                                                                  'CPCG0063',
                                                                  'CPCG0297',
                                                                  'CPCG0002',
                                                                  'CPCG0100',
                                                                  'CPCG0196',
                                                                  'CPCG0333',
                                                                  'CPCG0306',
                                                                  'CPCG0455',
                                                                  'CPCG0078',
                                                                  'CPCG0119',
                                                                  'CPCG0009',
                                                                  'CPCG0233',
                                                                  'CPCG0183',
                                                                  'CPCG0235',
                                                                  'CPCG0294',
                                                                  'CPCG0083',
                                                                  'CPCG0412',
                                                                  'CPCG0540',
                                                                  'CPCG0302',
                                                                  'CPCG0315',
                                                                  'CPCG0274',
                                                                  'CPCG0289',
                                                                  'CPCG0263',
                                                                  'CPCG0398',
                                                                  'CPCG0404',
                                                                  'CPCG0076',
                                                                  'CPCG0589',
                                                                  'CPCG0598',
                                                                  'CPCG0236',
                                                                  'CPCG0043',
                                                                  'CPCG0547',
                                                                  'CPCG0130',
                                                                  'CPCG0266',
                                                                  'CPCG0397',
                                                                  'CPCG0192',
                                                                  'CPCG0007',
                                                                  'CPCG0311',
                                                                  'CPCG0232',
                                                                  'CPCG0581',
                                                                  'CPCG0282',
                                                                  'CPCG0008',
                                                                  'CPCG0004',
                                                                  'CPCG0394',
                                                                  'CPCG0098',
                                                                  'CPCG0036',
                                                                  'CPCG0433',
                                                                  'CPCG0606',
                                                                  'CPCG0204',
                                                                  'CPCG0295',
                                                                  'CPCG0592',
                                                                  'CPCG0468',
                                                                  'CPCG0310',
                                                                  'CPCG0588',
                                                                  'CPCG0117',
                                                                  'CPCG0437',
                                                                  'CPCG0462',
                                                                  'CPCG0082',
                                                                  'CPCG0081',
                                                                  'CPCG0374',
                                                                  'CPCG0369',
                                                                  'CPCG0040',
                                                                  'CPCG0388',
                                                                  'CPCG0347',
                                                                  'CPCG0191',
                                                                  'CPCG0503',
                                                                  'CPCG0057',
                                                                  'CPCG0301',
                                                                  'CPCG0281',
                                                                  'CPCG0271',
                                                                  'CPCG0249',
                                                                  'CPCG0095',
                                                                  'CPCG0597',
                                                                  'CPCG0093',
                                                                  'CPCG0392',
                                                                  'CPCG0330',
                                                                  'CPCG0358',
                                                                  'CPCG0498',
                                                                  'CPCG0357',
                                                                  'CPCG0569',
                                                                  'CPCG0318',
                                                                  'CPCG0248',
                                                                  'CPCG0296',
                                                                  'CPCG0335',
                                                                  'CPCG0328',
                                                                  'CPCG0487',
                                                                  'CPCG0001',
                                                                  'CPCG0590',
                                                                  'CPCG0260',
                                                                  'CPCG0550',
                                                                  'CPCG0432',
                                                                  'CPCG0206',
                                                                  'CPCG0514',
                                                                  'CPCG0396',
                                                                  'CPCG0573',
                                                                  'CPCG0410',
                                                                  'CPCG0334',
                                                                  'CPCG0304',
                                                                  'CPCG0340',
                                                                  'CPCG0349',
                                                                  'CPCG0042',
                                                                  'CPCG0551',
                                                                  'CPCG0087',
                                                                  'CPCG0242',
                                                                  'CPCG0189',
                                                                  'CPCG0346',
                                                                  'CPCG0222',
                                                                  'CPCG0416',
                                                                  'CPCG0471',
                                                                  'CPCG0360',
                                                                  'CPCG0212',
                                                                  'CPCG0262',
                                                                  'CPCG0227',
                                                                  'CPCG0129',
                                                                  'CPCG0091',
                                                                  'CPCG0500',
                                                                  'CPCG0211',
                                                                  'CPCG0107',
                                                                  'CPCG0439',
                                                                  'CPCG0375',
                                                                  'CPCG0350',
                                                                  'CPCG0499',
                                                                  'CPCG0190',
                                                                  'CPCG0464',
                                                                  'CPCG0519',
                                                                  'CPCG0121',
                                                                  'CPCG0378',
                                                                  'CPCG0565',
                                                                  'CPCG0574',
                                                                  'CPCG0188',
                                                                  'CPCG0203',
                                                                  'CPCG0241',
                                                                  'CPCG0601',
                                                                  'CPCG0371',
                                                                  'CPCG0459',
                                                                  'CPCG0324',
                                                                  'CPCG0490',
                                                                  'CPCG0523',
                                                                  'CPCG0185',
                                                                  'CPCG0213',
                                                                  'CPCG0467',
                                                                  'CPCG0560',
                                                                  'CPCG0072',
                                                                  'CPCG0331',
                                                                  'CPCG0489',
                                                                  'CPCG0407',
                                                                  'CPCG0572',
                                                                  'CPCG0380',
                                                                  'CPCG0308',
                                                                  'CPCG0194',
                                                                  'CPCG0577',
                                                                  'CPCG0221',
                                                                  'CPCG0395',
                                                                  'CPCG0434',
                                                                  'CPCG0406',
                                                                  'CPCG0303',
                                                                  'CPCG0426',
                                                                  'CPCG0472',
                                                                  'CPCG0131',
                                                                  'CPCG0607',
                                                                  'CPCG0210',
                                                                  'CPCG0228',
                                                                  'CPCG0502',
                                                                  'CPCG0291',
                                                                  'CPCG0341',
                                                                  'CPCG0255',
                                                                  'CPCG0352',
                                                                  'CPCG0372',
                                                                  'CPCG0356',
                                                                  'CPCG0238',
                                                                  'CPCG0268',
                                                                  'CPCG0125',
                                                                  'CPCG0344',
                                                                  'CPCG0059',
                                                                  'CPCG0265',
                                                                  'CPCG0128',
                                                                  'CPCG0353',
                                                                  'CPCG0019',
                                                                  'CPCG0319',
                                                                  'CPCG0413',
                                                                  'CPCG0048',
                                                                  'CPCG0605',
                                                                  'CPCG0283',
                                                                  'CPCG0313',
                                                                  'CPCG0015',
                                                                  'CPCG0561',
                                                                  'CPCG0096',
                                                                  'CPCG0280',
                                                                  'CPCG0578',
                                                                  'CPCG0182',
                                                                  'CPCG0305',
                                                                  'CPCG0339',
                                                                  'CPCG0208',
                                                                  'CPCG0445',
                                                                  'CPCG0534',
                                                                  'CPCG0600',
                                                                  'CPCG0496',
                                                                  'CPCG0124',
                                                                  'CPCG0220',
                                                                  'CPCG0075',
                                                                  'CPCG0354',
                                                                  'CPCG0452',
                                                                  'CPCG0418',
                                                                  'CPCG0409',
                                                                  'CPCG0364',
                                                                  'CPCG0387',
                                                                  'CPCG0199',
                                                                  'CPCG0278',
                                                                  'CPCG0285',
                                                                  'CPCG0465',
                                                                  'CPCG0348',
                                                                  'CPCG0522',
                                                                  'CPCG0046',
                                                                  'CPCG0408',
                                                                  'CPCG0529',
                                                                  'CPCG0123',
                                                                  'CPCG0114',
                                                                  'CPCG0563',
                                                                  'CPCG0423',
                                                                  'CPCG0596',
                                                                  'CPCG0229',
                                                                  'CPCG0200',
                                                                  'CPCG0484',
                                                                  'CPCG0258',
                                                                  'CPCG0533',
                                                                  'CPCG0377',
                                                                  'CPCG0571',
                                                                  'CPCG0342',
                                                                  'CPCG0269',
                                                                  'CPCG0482',
                                                                  'CPCG0458',
                                                                  'CPCG0532',
                                                                  'CPCG0401',
                                                                  'CPCG0463',
                                                                  'CPCG0604',
                                                                  'CPCG0225',
                                                                  'CPCG0531',
                                                                  'CPCG0066',
                                                                  'CPCG0576',
                                                                  'CPCG0089',
                                                                  'CPCG0205',
                                                                  'CPCG0097',
                                                                  'CPCG0090',
                                                                  'CPCG0362',
                                                                  'CPCG0267',
                                                                  'CPCG0030',
                                                                  'CPCG0074',
                                                                  'CPCG0456',
                                                                  'CPCG0246',
                                                                  'CPCG0568',
                                                                  'CPCG0336',
                                                                  'CPCG0286',
                                                                  'CPCG0570',
                                                                  'CPCG0256',
                                                                  'CPCG0361',
                                                                  'CPCG0326',
                                                                  'CPCG0329',
                                                                  'CPCG0428',
                                                                  'CPCG0005',
                                                                  'CPCG0435',
                                                                  'CPCG0300',
                                                                  'CPCG0257',
                                                                  'CPCG0355',
                                                                  'CPCG0504',
                                                                  'CPCG0593',
                                                                  'CPCG0470',
                                                                  'CPCG0492',
                                                                  'CPCG0599',
                                                                  'CPCG0365',
                                                                  'CPCG0259',
                                                                  'CPCG0414',
                                                                  'CPCG0559',
                                                                  'CPCG0217',
                                                                  'CPCG0521',
                                                                  'CPCG0451',
                                                                  'CPCG0027',
                                                                  'CPCG0084',
                                                                  'CPCG0219',
                                                                  'CPCG0602',
                                                                  'CPCG0070',
                                                                  'CPCG0566',
                                                                  'CPCG0524',
                                                                  'CPCG0411',
                                                                  'CPCG0528',
                                                                  'CPCG0309',
                                                                  'CPCG0520',
                                                                  'CPCG0567',
                                                                  'CPCG0251',
                                                                  'CPCG0508',
                                                                  'CPCG0466',
                                                                  'CPCG0312',
                                                                  'CPCG0234',
                                                                  'CPCG0166',
                                                                  'CPCG0474',
                                                                  'CPCG0594',
                                                                  'CPCG0103',
                                                                  'CPCG0391',
                                                                  'CPCG0373',
                                                                  'CPCG0363',
                                                                  'CPCG0415',
                                                                  'CPCG0562',
                                                                  'CPCG0575',
                                                                  'CPCG0127',
                                                                  'CPCG0486',
                                                                  'CPCG0020',
                                                                  'CPCG0483',
                                                                  'CPCG0424',
                                                                  'CPCG0226',
                                                                  'CPCG0327',
                                                                  'CPCG0381',
                                                                  'CPCG0595',
                                                                  'CPCG0526',
                                                                  'CPCG0587',
                                                                  'CPCG0154',
                                                                  'CPCG0067',
                                                                  'CPCG0580',
                                                                  'CPCG0368',
                                                                  'CPCG0603',
                                                                  'CPCG0050',
                                                                  'CPCG0250',
                                                                  'CPCG0525',
                                                                  'CPCG0527',
                                                                  'CPCG0022',
                                                                  'CPCG0539',
                                                                  'CPCG0277',
                                                                  'CPCG0102',
                                                                  'CPCG0122',
                                                                  'CPCG0198',
                                                                  'CPCG0237',
                                                                  'CPCG0243',
                                                                  'CPCG0287'
))
ZNRF3.PSA.TIDY$feature <- factor(ZNRF3.PSA.TIDY$feature, levels = c('CLINICAL.T.CAT', 'PSA', 'GLEASON'))

## DRAW PSA LEGEND HEATMAP ####
ZNRF3.PSA.HEATMAP <- ggplot(ZNRF3.PSA.TIDY, aes(x = sample, y = feature, fill = mutated)) + 
  geom_tile(color = "black", size = 0.1) + coord_equal(ratio = 5) +
  scale_fill_manual(name = "",
                    labels = c("Present", "Absent", "Missing"), values = c("lightblue", "blue"), na.value = "grey30") +
  scale_y_discrete(labels = c("Pre-Treatment PSA")) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    axis.text.y = element_text(face = "bold",
                               size = 18,
                               color = "black"),
    legend.title = element_blank(),
    legend.text = element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    plot.margin = unit(c(0, 0, 0, 0), units = "cm")
  )
ZNRF3.PSA.HEATMAP

#
#### CLINICAL T CATEGORY  HEATMAP ####
saveRDS(ZNRF3_CLIN_T, "/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_CLIN_T.rds")
ZNRF3_CLIN_T <- readRDS("/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_CLIN_T.rds")

## TIDY DATA ####
ZNRF3.CLIN_T.TIDY <- ZNRF3_CLIN_T %>% tidyr::gather(sample,mutated, 2:366)
ZNRF3.CLIN_T.TIDY$mutated <- factor(ZNRF3.CLIN_T.TIDY$mutated)
ZNRF3.CLIN_T.TIDY$sample <- factor(ZNRF3.CLIN_T.TIDY$sample, levels = c('CPCG0187',
                                                                        'CPCG0126',
                                                                        'CPCG0454',
                                                                        'CPCG0184',
                                                                        'CPCG0320',
                                                                        'CPCG0288',
                                                                        'CPCG0382',
                                                                        'CPCG0298',
                                                                        'CPCG0316',
                                                                        'CPCG0582',
                                                                        'CPCG0545',
                                                                        'CPCG0068',
                                                                        'CPCG0379',
                                                                        'CPCG0448',
                                                                        'CPCG0201',
                                                                        'CPCG0579',
                                                                        'CPCG0345',
                                                                        'CPCG0314',
                                                                        'CPCG0003',
                                                                        'CPCG0453',
                                                                        'CPCG0323',
                                                                        'CPCG0322',
                                                                        'CPCG0132',
                                                                        'CPCG0299',
                                                                        'CPCG0099',
                                                                        'CPCG0158',
                                                                        'CPCG0240',
                                                                        'CPCG0307',
                                                                        'CPCG0069',
                                                                        'CPCG0457',
                                                                        'CPCG0073',
                                                                        'CPCG0292',
                                                                        'CPCG0006',
                                                                        'CPCG0321',
                                                                        'CPCG0094',
                                                                        'CPCG0063',
                                                                        'CPCG0297',
                                                                        'CPCG0002',
                                                                        'CPCG0100',
                                                                        'CPCG0196',
                                                                        'CPCG0333',
                                                                        'CPCG0306',
                                                                        'CPCG0455',
                                                                        'CPCG0078',
                                                                        'CPCG0119',
                                                                        'CPCG0009',
                                                                        'CPCG0233',
                                                                        'CPCG0183',
                                                                        'CPCG0235',
                                                                        'CPCG0294',
                                                                        'CPCG0083',
                                                                        'CPCG0412',
                                                                        'CPCG0540',
                                                                        'CPCG0302',
                                                                        'CPCG0315',
                                                                        'CPCG0274',
                                                                        'CPCG0289',
                                                                        'CPCG0263',
                                                                        'CPCG0398',
                                                                        'CPCG0404',
                                                                        'CPCG0076',
                                                                        'CPCG0589',
                                                                        'CPCG0598',
                                                                        'CPCG0236',
                                                                        'CPCG0043',
                                                                        'CPCG0547',
                                                                        'CPCG0130',
                                                                        'CPCG0266',
                                                                        'CPCG0397',
                                                                        'CPCG0192',
                                                                        'CPCG0007',
                                                                        'CPCG0311',
                                                                        'CPCG0232',
                                                                        'CPCG0581',
                                                                        'CPCG0282',
                                                                        'CPCG0008',
                                                                        'CPCG0004',
                                                                        'CPCG0394',
                                                                        'CPCG0098',
                                                                        'CPCG0036',
                                                                        'CPCG0433',
                                                                        'CPCG0606',
                                                                        'CPCG0204',
                                                                        'CPCG0295',
                                                                        'CPCG0592',
                                                                        'CPCG0468',
                                                                        'CPCG0310',
                                                                        'CPCG0588',
                                                                        'CPCG0117',
                                                                        'CPCG0437',
                                                                        'CPCG0462',
                                                                        'CPCG0082',
                                                                        'CPCG0081',
                                                                        'CPCG0374',
                                                                        'CPCG0369',
                                                                        'CPCG0040',
                                                                        'CPCG0388',
                                                                        'CPCG0347',
                                                                        'CPCG0191',
                                                                        'CPCG0503',
                                                                        'CPCG0057',
                                                                        'CPCG0301',
                                                                        'CPCG0281',
                                                                        'CPCG0271',
                                                                        'CPCG0249',
                                                                        'CPCG0095',
                                                                        'CPCG0597',
                                                                        'CPCG0093',
                                                                        'CPCG0392',
                                                                        'CPCG0330',
                                                                        'CPCG0358',
                                                                        'CPCG0498',
                                                                        'CPCG0357',
                                                                        'CPCG0569',
                                                                        'CPCG0318',
                                                                        'CPCG0248',
                                                                        'CPCG0296',
                                                                        'CPCG0335',
                                                                        'CPCG0328',
                                                                        'CPCG0487',
                                                                        'CPCG0001',
                                                                        'CPCG0590',
                                                                        'CPCG0260',
                                                                        'CPCG0550',
                                                                        'CPCG0432',
                                                                        'CPCG0206',
                                                                        'CPCG0514',
                                                                        'CPCG0396',
                                                                        'CPCG0573',
                                                                        'CPCG0410',
                                                                        'CPCG0334',
                                                                        'CPCG0304',
                                                                        'CPCG0340',
                                                                        'CPCG0349',
                                                                        'CPCG0042',
                                                                        'CPCG0551',
                                                                        'CPCG0087',
                                                                        'CPCG0242',
                                                                        'CPCG0189',
                                                                        'CPCG0346',
                                                                        'CPCG0222',
                                                                        'CPCG0416',
                                                                        'CPCG0471',
                                                                        'CPCG0360',
                                                                        'CPCG0212',
                                                                        'CPCG0262',
                                                                        'CPCG0227',
                                                                        'CPCG0129',
                                                                        'CPCG0091',
                                                                        'CPCG0500',
                                                                        'CPCG0211',
                                                                        'CPCG0107',
                                                                        'CPCG0439',
                                                                        'CPCG0375',
                                                                        'CPCG0350',
                                                                        'CPCG0499',
                                                                        'CPCG0190',
                                                                        'CPCG0464',
                                                                        'CPCG0519',
                                                                        'CPCG0121',
                                                                        'CPCG0378',
                                                                        'CPCG0565',
                                                                        'CPCG0574',
                                                                        'CPCG0188',
                                                                        'CPCG0203',
                                                                        'CPCG0241',
                                                                        'CPCG0601',
                                                                        'CPCG0371',
                                                                        'CPCG0459',
                                                                        'CPCG0324',
                                                                        'CPCG0490',
                                                                        'CPCG0523',
                                                                        'CPCG0185',
                                                                        'CPCG0213',
                                                                        'CPCG0467',
                                                                        'CPCG0560',
                                                                        'CPCG0072',
                                                                        'CPCG0331',
                                                                        'CPCG0489',
                                                                        'CPCG0407',
                                                                        'CPCG0572',
                                                                        'CPCG0380',
                                                                        'CPCG0308',
                                                                        'CPCG0194',
                                                                        'CPCG0577',
                                                                        'CPCG0221',
                                                                        'CPCG0395',
                                                                        'CPCG0434',
                                                                        'CPCG0406',
                                                                        'CPCG0303',
                                                                        'CPCG0426',
                                                                        'CPCG0472',
                                                                        'CPCG0131',
                                                                        'CPCG0607',
                                                                        'CPCG0210',
                                                                        'CPCG0228',
                                                                        'CPCG0502',
                                                                        'CPCG0291',
                                                                        'CPCG0341',
                                                                        'CPCG0255',
                                                                        'CPCG0352',
                                                                        'CPCG0372',
                                                                        'CPCG0356',
                                                                        'CPCG0238',
                                                                        'CPCG0268',
                                                                        'CPCG0125',
                                                                        'CPCG0344',
                                                                        'CPCG0059',
                                                                        'CPCG0265',
                                                                        'CPCG0128',
                                                                        'CPCG0353',
                                                                        'CPCG0019',
                                                                        'CPCG0319',
                                                                        'CPCG0413',
                                                                        'CPCG0048',
                                                                        'CPCG0605',
                                                                        'CPCG0283',
                                                                        'CPCG0313',
                                                                        'CPCG0015',
                                                                        'CPCG0561',
                                                                        'CPCG0096',
                                                                        'CPCG0280',
                                                                        'CPCG0578',
                                                                        'CPCG0182',
                                                                        'CPCG0305',
                                                                        'CPCG0339',
                                                                        'CPCG0208',
                                                                        'CPCG0445',
                                                                        'CPCG0534',
                                                                        'CPCG0600',
                                                                        'CPCG0496',
                                                                        'CPCG0124',
                                                                        'CPCG0220',
                                                                        'CPCG0075',
                                                                        'CPCG0354',
                                                                        'CPCG0452',
                                                                        'CPCG0418',
                                                                        'CPCG0409',
                                                                        'CPCG0364',
                                                                        'CPCG0387',
                                                                        'CPCG0199',
                                                                        'CPCG0278',
                                                                        'CPCG0285',
                                                                        'CPCG0465',
                                                                        'CPCG0348',
                                                                        'CPCG0522',
                                                                        'CPCG0046',
                                                                        'CPCG0408',
                                                                        'CPCG0529',
                                                                        'CPCG0123',
                                                                        'CPCG0114',
                                                                        'CPCG0563',
                                                                        'CPCG0423',
                                                                        'CPCG0596',
                                                                        'CPCG0229',
                                                                        'CPCG0200',
                                                                        'CPCG0484',
                                                                        'CPCG0258',
                                                                        'CPCG0533',
                                                                        'CPCG0377',
                                                                        'CPCG0571',
                                                                        'CPCG0342',
                                                                        'CPCG0269',
                                                                        'CPCG0482',
                                                                        'CPCG0458',
                                                                        'CPCG0532',
                                                                        'CPCG0401',
                                                                        'CPCG0463',
                                                                        'CPCG0604',
                                                                        'CPCG0225',
                                                                        'CPCG0531',
                                                                        'CPCG0066',
                                                                        'CPCG0576',
                                                                        'CPCG0089',
                                                                        'CPCG0205',
                                                                        'CPCG0097',
                                                                        'CPCG0090',
                                                                        'CPCG0362',
                                                                        'CPCG0267',
                                                                        'CPCG0030',
                                                                        'CPCG0074',
                                                                        'CPCG0456',
                                                                        'CPCG0246',
                                                                        'CPCG0568',
                                                                        'CPCG0336',
                                                                        'CPCG0286',
                                                                        'CPCG0570',
                                                                        'CPCG0256',
                                                                        'CPCG0361',
                                                                        'CPCG0326',
                                                                        'CPCG0329',
                                                                        'CPCG0428',
                                                                        'CPCG0005',
                                                                        'CPCG0435',
                                                                        'CPCG0300',
                                                                        'CPCG0257',
                                                                        'CPCG0355',
                                                                        'CPCG0504',
                                                                        'CPCG0593',
                                                                        'CPCG0470',
                                                                        'CPCG0492',
                                                                        'CPCG0599',
                                                                        'CPCG0365',
                                                                        'CPCG0259',
                                                                        'CPCG0414',
                                                                        'CPCG0559',
                                                                        'CPCG0217',
                                                                        'CPCG0521',
                                                                        'CPCG0451',
                                                                        'CPCG0027',
                                                                        'CPCG0084',
                                                                        'CPCG0219',
                                                                        'CPCG0602',
                                                                        'CPCG0070',
                                                                        'CPCG0566',
                                                                        'CPCG0524',
                                                                        'CPCG0411',
                                                                        'CPCG0528',
                                                                        'CPCG0309',
                                                                        'CPCG0520',
                                                                        'CPCG0567',
                                                                        'CPCG0251',
                                                                        'CPCG0508',
                                                                        'CPCG0466',
                                                                        'CPCG0312',
                                                                        'CPCG0234',
                                                                        'CPCG0166',
                                                                        'CPCG0474',
                                                                        'CPCG0594',
                                                                        'CPCG0103',
                                                                        'CPCG0391',
                                                                        'CPCG0373',
                                                                        'CPCG0363',
                                                                        'CPCG0415',
                                                                        'CPCG0562',
                                                                        'CPCG0575',
                                                                        'CPCG0127',
                                                                        'CPCG0486',
                                                                        'CPCG0020',
                                                                        'CPCG0483',
                                                                        'CPCG0424',
                                                                        'CPCG0226',
                                                                        'CPCG0327',
                                                                        'CPCG0381',
                                                                        'CPCG0595',
                                                                        'CPCG0526',
                                                                        'CPCG0587',
                                                                        'CPCG0154',
                                                                        'CPCG0067',
                                                                        'CPCG0580',
                                                                        'CPCG0368',
                                                                        'CPCG0603',
                                                                        'CPCG0050',
                                                                        'CPCG0250',
                                                                        'CPCG0525',
                                                                        'CPCG0527',
                                                                        'CPCG0022',
                                                                        'CPCG0539',
                                                                        'CPCG0277',
                                                                        'CPCG0102',
                                                                        'CPCG0122',
                                                                        'CPCG0198',
                                                                        'CPCG0237',
                                                                        'CPCG0243',
                                                                        'CPCG0287'
))
ZNRF3.CLIN_T.TIDY$feature <- factor(ZNRF3.CLIN_T.TIDY$feature, levels = c('CLINICAL.T.CAT', 'PSA', 'GLEASON'))

## DRAW CLINICAL T-CATEGORY LEGEND HEATMAP ####
ZNRF3.CLIN_T.HEATMAP <- ggplot(ZNRF3.CLIN_T.TIDY, aes(x = sample, y = feature, fill = mutated)) + 
  geom_tile(color = "black", size = 0.1) + coord_equal(ratio = 5) +
  scale_fill_manual(name = "",
                    labels = c("Present", "Absent", "Missing"), values = c("green", "darkgreen"), na.value = "grey30") +
  scale_y_discrete(labels = c("Clinical T Category")) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    axis.text.y = element_text(face = "bold",
                               size = 18,
                               color = "black"),
    legend.title = element_blank(),
    legend.text = element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    plot.margin = unit(c(0, 0, 0, 0), "mm")
  )
ZNRF3.CLIN_T.HEATMAP


#
#### TREATMENT TYPE ####

saveRDS(ZNRF3_TREATMENT, "/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_TREATMENT.rds")
ZNRF3_TREATMENT <- readRDS("/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_TREATMENT.rds")

## TIDY DATA ####
ZNRF3.TREATMENT.TIDY <- ZNRF3_TREATMENT %>% tidyr::gather(sample,mutated, 2:366)
ZNRF3.TREATMENT.TIDY$mutated <- factor(ZNRF3.TREATMENT.TIDY$mutated)
ZNRF3.TREATMENT.TIDY$sample <- factor(ZNRF3.TREATMENT.TIDY$sample, levels = c('CPCG0187',
                                                                              'CPCG0126',
                                                                              'CPCG0454',
                                                                              'CPCG0184',
                                                                              'CPCG0320',
                                                                              'CPCG0288',
                                                                              'CPCG0382',
                                                                              'CPCG0298',
                                                                              'CPCG0316',
                                                                              'CPCG0582',
                                                                              'CPCG0545',
                                                                              'CPCG0068',
                                                                              'CPCG0379',
                                                                              'CPCG0448',
                                                                              'CPCG0201',
                                                                              'CPCG0579',
                                                                              'CPCG0345',
                                                                              'CPCG0314',
                                                                              'CPCG0003',
                                                                              'CPCG0453',
                                                                              'CPCG0323',
                                                                              'CPCG0322',
                                                                              'CPCG0132',
                                                                              'CPCG0299',
                                                                              'CPCG0099',
                                                                              'CPCG0158',
                                                                              'CPCG0240',
                                                                              'CPCG0307',
                                                                              'CPCG0069',
                                                                              'CPCG0457',
                                                                              'CPCG0073',
                                                                              'CPCG0292',
                                                                              'CPCG0006',
                                                                              'CPCG0321',
                                                                              'CPCG0094',
                                                                              'CPCG0063',
                                                                              'CPCG0297',
                                                                              'CPCG0002',
                                                                              'CPCG0100',
                                                                              'CPCG0196',
                                                                              'CPCG0333',
                                                                              'CPCG0306',
                                                                              'CPCG0455',
                                                                              'CPCG0078',
                                                                              'CPCG0119',
                                                                              'CPCG0009',
                                                                              'CPCG0233',
                                                                              'CPCG0183',
                                                                              'CPCG0235',
                                                                              'CPCG0294',
                                                                              'CPCG0083',
                                                                              'CPCG0412',
                                                                              'CPCG0540',
                                                                              'CPCG0302',
                                                                              'CPCG0315',
                                                                              'CPCG0274',
                                                                              'CPCG0289',
                                                                              'CPCG0263',
                                                                              'CPCG0398',
                                                                              'CPCG0404',
                                                                              'CPCG0076',
                                                                              'CPCG0589',
                                                                              'CPCG0598',
                                                                              'CPCG0236',
                                                                              'CPCG0043',
                                                                              'CPCG0547',
                                                                              'CPCG0130',
                                                                              'CPCG0266',
                                                                              'CPCG0397',
                                                                              'CPCG0192',
                                                                              'CPCG0007',
                                                                              'CPCG0311',
                                                                              'CPCG0232',
                                                                              'CPCG0581',
                                                                              'CPCG0282',
                                                                              'CPCG0008',
                                                                              'CPCG0004',
                                                                              'CPCG0394',
                                                                              'CPCG0098',
                                                                              'CPCG0036',
                                                                              'CPCG0433',
                                                                              'CPCG0606',
                                                                              'CPCG0204',
                                                                              'CPCG0295',
                                                                              'CPCG0592',
                                                                              'CPCG0468',
                                                                              'CPCG0310',
                                                                              'CPCG0588',
                                                                              'CPCG0117',
                                                                              'CPCG0437',
                                                                              'CPCG0462',
                                                                              'CPCG0082',
                                                                              'CPCG0081',
                                                                              'CPCG0374',
                                                                              'CPCG0369',
                                                                              'CPCG0040',
                                                                              'CPCG0388',
                                                                              'CPCG0347',
                                                                              'CPCG0191',
                                                                              'CPCG0503',
                                                                              'CPCG0057',
                                                                              'CPCG0301',
                                                                              'CPCG0281',
                                                                              'CPCG0271',
                                                                              'CPCG0249',
                                                                              'CPCG0095',
                                                                              'CPCG0597',
                                                                              'CPCG0093',
                                                                              'CPCG0392',
                                                                              'CPCG0330',
                                                                              'CPCG0358',
                                                                              'CPCG0498',
                                                                              'CPCG0357',
                                                                              'CPCG0569',
                                                                              'CPCG0318',
                                                                              'CPCG0248',
                                                                              'CPCG0296',
                                                                              'CPCG0335',
                                                                              'CPCG0328',
                                                                              'CPCG0487',
                                                                              'CPCG0001',
                                                                              'CPCG0590',
                                                                              'CPCG0260',
                                                                              'CPCG0550',
                                                                              'CPCG0432',
                                                                              'CPCG0206',
                                                                              'CPCG0514',
                                                                              'CPCG0396',
                                                                              'CPCG0573',
                                                                              'CPCG0410',
                                                                              'CPCG0334',
                                                                              'CPCG0304',
                                                                              'CPCG0340',
                                                                              'CPCG0349',
                                                                              'CPCG0042',
                                                                              'CPCG0551',
                                                                              'CPCG0087',
                                                                              'CPCG0242',
                                                                              'CPCG0189',
                                                                              'CPCG0346',
                                                                              'CPCG0222',
                                                                              'CPCG0416',
                                                                              'CPCG0471',
                                                                              'CPCG0360',
                                                                              'CPCG0212',
                                                                              'CPCG0262',
                                                                              'CPCG0227',
                                                                              'CPCG0129',
                                                                              'CPCG0091',
                                                                              'CPCG0500',
                                                                              'CPCG0211',
                                                                              'CPCG0107',
                                                                              'CPCG0439',
                                                                              'CPCG0375',
                                                                              'CPCG0350',
                                                                              'CPCG0499',
                                                                              'CPCG0190',
                                                                              'CPCG0464',
                                                                              'CPCG0519',
                                                                              'CPCG0121',
                                                                              'CPCG0378',
                                                                              'CPCG0565',
                                                                              'CPCG0574',
                                                                              'CPCG0188',
                                                                              'CPCG0203',
                                                                              'CPCG0241',
                                                                              'CPCG0601',
                                                                              'CPCG0371',
                                                                              'CPCG0459',
                                                                              'CPCG0324',
                                                                              'CPCG0490',
                                                                              'CPCG0523',
                                                                              'CPCG0185',
                                                                              'CPCG0213',
                                                                              'CPCG0467',
                                                                              'CPCG0560',
                                                                              'CPCG0072',
                                                                              'CPCG0331',
                                                                              'CPCG0489',
                                                                              'CPCG0407',
                                                                              'CPCG0572',
                                                                              'CPCG0380',
                                                                              'CPCG0308',
                                                                              'CPCG0194',
                                                                              'CPCG0577',
                                                                              'CPCG0221',
                                                                              'CPCG0395',
                                                                              'CPCG0434',
                                                                              'CPCG0406',
                                                                              'CPCG0303',
                                                                              'CPCG0426',
                                                                              'CPCG0472',
                                                                              'CPCG0131',
                                                                              'CPCG0607',
                                                                              'CPCG0210',
                                                                              'CPCG0228',
                                                                              'CPCG0502',
                                                                              'CPCG0291',
                                                                              'CPCG0341',
                                                                              'CPCG0255',
                                                                              'CPCG0352',
                                                                              'CPCG0372',
                                                                              'CPCG0356',
                                                                              'CPCG0238',
                                                                              'CPCG0268',
                                                                              'CPCG0125',
                                                                              'CPCG0344',
                                                                              'CPCG0059',
                                                                              'CPCG0265',
                                                                              'CPCG0128',
                                                                              'CPCG0353',
                                                                              'CPCG0019',
                                                                              'CPCG0319',
                                                                              'CPCG0413',
                                                                              'CPCG0048',
                                                                              'CPCG0605',
                                                                              'CPCG0283',
                                                                              'CPCG0313',
                                                                              'CPCG0015',
                                                                              'CPCG0561',
                                                                              'CPCG0096',
                                                                              'CPCG0280',
                                                                              'CPCG0578',
                                                                              'CPCG0182',
                                                                              'CPCG0305',
                                                                              'CPCG0339',
                                                                              'CPCG0208',
                                                                              'CPCG0445',
                                                                              'CPCG0534',
                                                                              'CPCG0600',
                                                                              'CPCG0496',
                                                                              'CPCG0124',
                                                                              'CPCG0220',
                                                                              'CPCG0075',
                                                                              'CPCG0354',
                                                                              'CPCG0452',
                                                                              'CPCG0418',
                                                                              'CPCG0409',
                                                                              'CPCG0364',
                                                                              'CPCG0387',
                                                                              'CPCG0199',
                                                                              'CPCG0278',
                                                                              'CPCG0285',
                                                                              'CPCG0465',
                                                                              'CPCG0348',
                                                                              'CPCG0522',
                                                                              'CPCG0046',
                                                                              'CPCG0408',
                                                                              'CPCG0529',
                                                                              'CPCG0123',
                                                                              'CPCG0114',
                                                                              'CPCG0563',
                                                                              'CPCG0423',
                                                                              'CPCG0596',
                                                                              'CPCG0229',
                                                                              'CPCG0200',
                                                                              'CPCG0484',
                                                                              'CPCG0258',
                                                                              'CPCG0533',
                                                                              'CPCG0377',
                                                                              'CPCG0571',
                                                                              'CPCG0342',
                                                                              'CPCG0269',
                                                                              'CPCG0482',
                                                                              'CPCG0458',
                                                                              'CPCG0532',
                                                                              'CPCG0401',
                                                                              'CPCG0463',
                                                                              'CPCG0604',
                                                                              'CPCG0225',
                                                                              'CPCG0531',
                                                                              'CPCG0066',
                                                                              'CPCG0576',
                                                                              'CPCG0089',
                                                                              'CPCG0205',
                                                                              'CPCG0097',
                                                                              'CPCG0090',
                                                                              'CPCG0362',
                                                                              'CPCG0267',
                                                                              'CPCG0030',
                                                                              'CPCG0074',
                                                                              'CPCG0456',
                                                                              'CPCG0246',
                                                                              'CPCG0568',
                                                                              'CPCG0336',
                                                                              'CPCG0286',
                                                                              'CPCG0570',
                                                                              'CPCG0256',
                                                                              'CPCG0361',
                                                                              'CPCG0326',
                                                                              'CPCG0329',
                                                                              'CPCG0428',
                                                                              'CPCG0005',
                                                                              'CPCG0435',
                                                                              'CPCG0300',
                                                                              'CPCG0257',
                                                                              'CPCG0355',
                                                                              'CPCG0504',
                                                                              'CPCG0593',
                                                                              'CPCG0470',
                                                                              'CPCG0492',
                                                                              'CPCG0599',
                                                                              'CPCG0365',
                                                                              'CPCG0259',
                                                                              'CPCG0414',
                                                                              'CPCG0559',
                                                                              'CPCG0217',
                                                                              'CPCG0521',
                                                                              'CPCG0451',
                                                                              'CPCG0027',
                                                                              'CPCG0084',
                                                                              'CPCG0219',
                                                                              'CPCG0602',
                                                                              'CPCG0070',
                                                                              'CPCG0566',
                                                                              'CPCG0524',
                                                                              'CPCG0411',
                                                                              'CPCG0528',
                                                                              'CPCG0309',
                                                                              'CPCG0520',
                                                                              'CPCG0567',
                                                                              'CPCG0251',
                                                                              'CPCG0508',
                                                                              'CPCG0466',
                                                                              'CPCG0312',
                                                                              'CPCG0234',
                                                                              'CPCG0166',
                                                                              'CPCG0474',
                                                                              'CPCG0594',
                                                                              'CPCG0103',
                                                                              'CPCG0391',
                                                                              'CPCG0373',
                                                                              'CPCG0363',
                                                                              'CPCG0415',
                                                                              'CPCG0562',
                                                                              'CPCG0575',
                                                                              'CPCG0127',
                                                                              'CPCG0486',
                                                                              'CPCG0020',
                                                                              'CPCG0483',
                                                                              'CPCG0424',
                                                                              'CPCG0226',
                                                                              'CPCG0327',
                                                                              'CPCG0381',
                                                                              'CPCG0595',
                                                                              'CPCG0526',
                                                                              'CPCG0587',
                                                                              'CPCG0154',
                                                                              'CPCG0067',
                                                                              'CPCG0580',
                                                                              'CPCG0368',
                                                                              'CPCG0603',
                                                                              'CPCG0050',
                                                                              'CPCG0250',
                                                                              'CPCG0525',
                                                                              'CPCG0527',
                                                                              'CPCG0022',
                                                                              'CPCG0539',
                                                                              'CPCG0277',
                                                                              'CPCG0102',
                                                                              'CPCG0122',
                                                                              'CPCG0198',
                                                                              'CPCG0237',
                                                                              'CPCG0243',
                                                                              'CPCG0287'
))
ZNRF3.TREATMENT.TIDY$feature <- factor(ZNRF3.TREATMENT.TIDY$feature, levels = c('CLINICAL.T.CAT', 'PSA', 'GLEASON'))

## DRAW TREATMENT TYPE LEGEND HEATMAP ####
ZNRF3.TREATMENT.HEATMAP <- ggplot(ZNRF3.TREATMENT.TIDY, aes(x = sample, y = feature, fill = mutated)) + 
  geom_tile(color = "black", size = 0.1) + coord_equal(ratio = 5) +
  scale_fill_manual(name = "",
                    labels = c("Present", "Absent", "Missing"), values = c("dodgerblue1", "orange"), na.value = "grey30") +
  scale_y_discrete(labels = c("Treatment Type")) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    axis.text.y = element_text(face = "bold",
                               size = 18,
                               color = "black"),
    legend.title = element_blank(),
    legend.text = element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    plot.margin = unit(c(0, 0, 0, 0), "cm")
  )
ZNRF3.TREATMENT.HEATMAP


#
#### CONTINUOUS VARIABLES BARPLOTS ####

saveRDS(ZNRF3_CONTINUOUS, "/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_CONTINUOUS.rds")
ZNRF3_CONTINUOUS <- readRDS("/Users/michaelfraser/OneDrive/Work/Manuscripts/2020/ZNRF3/FINAL/Nature Cancer/Data and Code/ZNRF3_CONTINUOUS.rds")

## DRAW PGA BARPLOT ####
ZNRF3.CONTINUOUS.BARPLOT.PGA <- ggplot(ZNRF3_CONTINUOUS, aes(x = index, y = PGA, fill = ZNRF3)) +
  geom_bar(stat = "identity", size = 0.1, aes(fill = ZNRF3)) +
  scale_y_continuous(expand = c(0,0)) +
  scale_x_continuous(expand = c(0,0)) +
  scale_fill_manual(values = c("black", "dodgerblue1")) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    axis.text.y = element_text(face = "bold",
                               size = 16,
                               color = "black"),
    legend.title = element_blank(),
    legend.text = element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    panel.border = element_rect(fill = NA, size = 1)
  )

ZNRF3.CONTINUOUS.BARPLOT.PGA

##### DRAW AGE OF ONSET BARPLOT #####

ZNRF3.CONTINUOUS.BARPLOT.AGE <- ggplot(ZNRF3_CONTINUOUS, aes(x = index, y = AGE, fill = ZNRF3)) +
  geom_bar(stat = "identity", size = 0.1) +
  scale_y_continuous(expand = c(0,0)) +
  scale_x_continuous(expand = c(0,0)) +
  scale_fill_manual(values = c("black", "dodgerblue1")) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    axis.text.y = element_text(face = "bold",
                               size = 16,
                               color = "black"),
    legend.title = element_blank(),
    legend.text = element_blank(),
    legend.position = "none",
    panel.background = element_blank(),
    panel.border = element_rect(fill = NA, size = 1)
  )

ZNRF3.CONTINUOUS.BARPLOT.AGE


#### MERGE PLOTS ####

continuous.plots.merged <- ZNRF3.CONTINUOUS.BARPLOT.PGA / ZNRF3.CONTINUOUS.BARPLOT.AGE
continuous.plots.merged

discrete.plots.merged <-ZNRF3.BINARY.HEATMAP / ZNRF3.GLEASON.HEATMAP / ZNRF3.PSA.HEATMAP / ZNRF3.CLIN_T.HEATMAP / ZNRF3.TREATMENT.HEATMAP
discrete.plots.merged

Final.Plot <- continuous.plots.merged / discrete.plots.merged
Final.Plot
